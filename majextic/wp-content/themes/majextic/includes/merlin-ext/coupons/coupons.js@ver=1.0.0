(function($){'use strict';$(document).on('click','[data-toggle="majextic-coupon-modal"]',function(e){e.preventDefault();e.stopPropagation();var $target=$($(this).data('target'));$target.toggleClass('open');$.ajax({type:'POST',url:majexticVariable.ajaxurl,data:{action:'majextic_load_coupon',},success:function(response){$target.find('.modal-list-coupons').html(response);},beforeSend:function(){$target.addClass('progressing');},complete:function(){$target.removeClass('progressing');}});}).on('click','.apply-coupon-link',function(){let $link=$(this),couponCode=$link.data('coupon')
if($link.hasClass('coupon-selected')){return;}
if($link.hasClass('coupon-disabled')){return;}
$.ajax({type:'POST',url:majexticVariable.ajaxurl,data:{action:'majextic_apply_coupon',coupon_code:couponCode,security:majexticVariable.apply_coupon_nonce},dataType:'json',success:function(response){},beforeSend:function(){$('#modal-cart-coupon').addClass('progressing');$link.addClass('coupon-selected');},complete:function(){$('#modal-cart-coupon').removeClass('open progressing');$(document.body).trigger('wc_update_cart').trigger('wc_fragment_refresh')
if(majexticVariable.is_checkout){$(document.body).trigger('update_checkout');}}});}).on('click','.minicart-coupons .coupon-remove',function(){let $this=$(this),couponCode=$this.data('code')
$.ajax({type:'POST',url:majexticVariable.ajaxurl,data:{action:'majextic_remove_coupon',coupon_code:couponCode,},success:function(response){console.log(response);},beforeSend:function(){$this.closest('.coupon-added').remove();},complete:function(){$(document.body).trigger('wc_update_cart').trigger('wc_fragment_refresh')}});}).on('click','.minicart-coupons .coupon-button',function(e){let $this=$(this),$input=$this.closest('.coupon-form').find('.coupon-input'),couponCode=$input.val()
if(couponCode===''){return;}
$.ajax({type:'POST',url:majexticVariable.ajaxurl,data:{action:'majextic_apply_coupon',coupon_code:couponCode,security:majexticVariable.apply_coupon_nonce},dataType:'json',success:function(response){},beforeSend:function(){$input.prop('disabled',true);$this.prop('disabled',true)},complete:function(){$(document.body).trigger('wc_update_cart').trigger('wc_fragment_refresh')
$this.prop('disabled',false);$input.prop('disabled',false);}});})})(jQuery);